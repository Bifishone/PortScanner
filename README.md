# 🚀 PortScanner - 多线程端口扫描工具

<img width="2363" height="1194" alt="image" src="https://github.com/user-attachments/assets/4a51e8d9-d54e-436e-b753-f3dbb480b2f2" />


一款功能强大的多线程端口扫描工具，支持批量 IP 扫描、多种端口格式输入、扫描结果美化导出，适用于网络安全检测与端口监控场景。

## 🌟 功能特性

- 🔍 **灵活的扫描目标**：支持单个 IP 或从文件批量导入 IP 列表（支持注释行）
- 🔌 **多样化端口指定**：支持单个端口、端口范围（如 1-100）、多端口组合（如 80,443,3306）及从文件读取
- 🚀 **多线程加速**：可自定义线程数量（1-100），大幅提升扫描效率
- 📊 **直观结果展示**：彩色终端输出，清晰区分开放端口与端口描述
- � Excel **精美导出**：自动生成格式化 Excel 报告，包含端口详情与状态，支持自动调整列宽与冻结表头
- 🔖 **端口描述库**：通过`port.ini`文件加载端口服务信息，未知端口自动标记
- ⏱️ **超时控制**：可自定义连接超时时间，平衡扫描速度与准确性
- 🧹 **智能去重**：自动处理重复 IP 与端口，避免无效扫描
- 🌐 **跨平台支持**：兼容 Windows、Linux 与 macOS 系统

## 📸 界面预览

```plaintext
____            _   ____
|  _ \ ___  _ __| |_/ ___|  ___ __ _ _ __  _ __   ___ _ __
| |_) / _ \| '__| __\___ \ / __/ _` | '_ \| '_ \ / _ \ '__|
|  __/ (_) | |  | |_ ___) | (_| (_| | | | | | | |  __/ |
|_|   \___/|_|   \__|____/ \___\__,_|_| |_|_| |_|\___|_|

------------------------------------------------------------
                    Author: 一只鱼（Bifishone）
                    GitHub: https://github.com/Bifishone
------------------------------------------------------------

开始扫描: 2 个IP, 5 个端口
超时时间: 3.0 秒, 线程数量: 10
--------------------------------------------------------------------------------

192.168.1.1:80                HTTP (超文本传输协议)                        开放
192.168.1.1:443               HTTPS (加密的超文本传输协议)                  开放

扫描进度: 100.0% (10/10)
--------------------------------------------------------------------------------
扫描完成! 耗时: 2.34 秒
总开放端口数: 2

IP: 192.168.1.1 开放的端口:
  80  (HTTP (超文本传输协议)), 443 (HTTPS (加密的超文本传输协议))

--------------------------------------------------------------------------------

扫描结果已导出到Excel文件: result.xlsx
```

## 🛠️ 安装指南

### 前置要求

- Python 3.6 及以上版本

### 安装步骤

1. 克隆仓库

```bash
git clone https://github.com/Bifishone/PortScanner.git
cd PortScanner
```



1. 安装依赖包

```bash
pip install colorama openpyxl
```



1. （可选）配置端口描述文件

   如需自定义端口描述，在项目根目录创建

   ```
   port.ini
   ```

   文件，格式如下：

   ```ini
   80  # HTTP (超文本传输协议)
   443 # HTTPS (加密的超文本传输协议)
   3306# MySQL数据库
   22  # SSH (远程登录协议)
   ```

## 📖 使用说明

### 命令格式

```bash
python PortScanner.py [IP参数] [端口参数] [可选参数]
```

### 核心参数

| 参数       | 说明                             | 示例                                 |
| ---------- | -------------------------------- | ------------------------------------ |
| `-ip`      | 指定单个 IP 地址                 | `-ip 192.168.1.1`                    |
| `-ip-list` | 从文件读取 IP 列表（支持 #注释） | `-ip-list ips.txt`                   |
| `-p`       | 指定端口（单个 / 范围 / 多个）   | `-p 80` 或 `-p 1-100` 或 `-p 80,443` |
| `-p-list`  | 从文件读取端口列表（支持 #注释） | `-p-list ports.txt`                  |
| `-t`       | 超时时间（秒），默认 3 秒        | `-t 5`                               |
| `-threads` | 线程数量（1-100），默认 5 个     | `-threads 20`                        |

### 使用示例

1. 扫描单个 IP 的指定端口

```bash
python PortScanner.py -ip 192.168.1.1 -p 80,443,3306 -threads 10
```



1. 从文件读取 IP 列表，扫描端口范围

```bash
python PortScanner.py -ip-list ips.txt -p 1-1000 -t 4 -threads 15
```



1. 扫描单个 IP 的常用端口（从文件读取）

```bash
python PortScanner.py -ip 8.8.8.8 -p-list common_ports.txt
```

## 📁 项目结构

```plaintext
PortScanner/
├── PortScanner.py       # 主程序
├── port.ini             # 端口描述文件（可选）
├── ips.txt              # IP列表示例文件
├── ports.txt            # 端口列表示例文件
└── requirements.txt     # 依赖列表
```

## 📋 输出说明

1. **终端输出**：

   - 彩色区分不同类型信息（IP、端口描述、状态）
   - 实时显示扫描进度
   - 汇总统计开放端口数量与耗时
   - 按 IP 分组展示开放端口详情

2. **Excel 报告**：

   - 自动生成不重复文件名（如`result.xlsx`、`result_1.xlsx`）
   - 包含目标地址、IP、端口、端口描述、状态等字段
   - 美化样式：表头蓝色背景、偶数行灰色底色、边框线条
   - 自动调整列宽，冻结表头方便浏览

   <img width="1039" height="323" alt="image" src="https://github.com/user-attachments/assets/c6ec8753-449c-426a-b8a7-8157eb990e92" />


## 🔒 注意事项

- 请遵守网络安全法规，仅在授权范围内使用本工具
- 大量线程可能导致目标网络拥塞，建议合理设置线程数量
- 部分网络环境可能限制 ICMP 或 TCP 连接，导致扫描结果不准确
- 防火墙可能影响扫描结果，建议在可控环境中测试

## 🤝 贡献指南

欢迎提交 Issue 或 Pull Request 改进本工具，贡献步骤：

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add some amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 打开 Pull Request

## 📄 许可证

本项目采用 MIT 许可证 - 详见 LICENSE 文件

## 👤 作者信息

- 作者：一只鱼（Bifishone）
- GitHub：https://github.com/Bifishone

------



✨ 感谢使用 PortScanner！如有任何问题或建议，欢迎联系反馈。
